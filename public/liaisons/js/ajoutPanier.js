/**
 * @file La Pastèque - Choix nombre de livre et ajout au panier
 * @author Anaïs Mannée-Batschy
 * @version 0.0.1
 */
const refLivre=document.querySelector(".ajoutPanier__livreId"),refNbLivre=document.querySelector(".ajoutPanier__nbLivre"),refBtnPlus=document.querySelector(".ajoutPanier__plus"),refBtnMoins=document.querySelector(".ajoutPanier__moins"),refBtnAjoutPanier=document.querySelector(".ajoutPanier__btnPanier"),btnPanierRetroLivre=document.querySelector(".menu__nbArticle"),form=document.querySelector(".ajoutPanier");function gererRechargementPage(){const r=document.querySelector(".ajoutPanier");r.addEventListener("submit",e=>{e.preventDefault();e=new FormData(r),document.querySelector(".ajoutPanier");fetch("index.php?controleur=livre&action=fiche&idLivre="+refLivre.value,{method:"POST",body:e}).then(e=>{e.ok?console.log("Form submitted successfully!"):console.log("There was an error submitting the form")}).catch(e=>{console.log("There was an error submitting the form:"+e)})})}function gererNbLivre(){refNbArticle=document.querySelector(".menu__nbArticle"),"0"===btnPanierRetroLivre.innerText&&localStorage.setItem("nbLivre",btnPanierRetroLivre.innerText),localStorage.getItem("nbLivre")!==btnPanierRetroLivre.innerText&&(btnPanierRetroLivre.classList.add("animate__heartBeat"),enregistrerDansLocalStorage(),afficherLaModale())}function enregistrerDansLocalStorage(){valLS=parseInt(localStorage.getItem("nbLivre")),nouvelleValeur=(valLS+1).toString(),localStorage.setItem("nbLivre",nouvelleValeur)}function afficherLaModale(){document.querySelector(".modaleAjoutPanier").classList.remove("visuallyhidden"),document.querySelector(".nbLivreChoisi").innerText=refNbLivre.value}function cacherLaModale(){document.querySelector(".modaleAjoutPanier").classList.add("visuallyhidden")}function modifierNbLivres(e){intNbLivre=parseInt(refNbLivre.value),"plus"===e.target.id?intNbLivre<6&&intNbLivre++:"moins"===e.target.id&&1<intNbLivre&&intNbLivre--,refNbLivre.value=intNbLivre,afficherBoutonMoins(),afficherBoutonPlus()}function afficherBoutonMoins(){1===parseInt(refNbLivre.value)?refBtnMoins.setAttribute("disabled",""):refBtnMoins.removeAttribute("disabled")}function afficherBoutonPlus(){6===parseInt(refNbLivre.value)?refBtnPlus.setAttribute("disabled",""):refBtnPlus.removeAttribute("disabled")}window.addEventListener("load",afficherBoutonMoins),window.addEventListener("load",afficherBoutonPlus),refBtnPlus.addEventListener("click",modifierNbLivres),refBtnMoins.addEventListener("click",modifierNbLivres),form.addEventListener("submit",gererRechargementPage),window.addEventListener("load",gererNbLivre),refBtnAjoutPanier.addEventListener("click",gererNbLivre),refBtnAjoutPanier.addEventListener("click",afficherLaModale),document.querySelector(".btnLivre").addEventListener("click",cacherLaModale);