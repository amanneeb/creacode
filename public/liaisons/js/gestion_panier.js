/**
 * @file La Pastèque - Gestion du panier
 * @author Anaïs Mannée-Batschy
 * @version 0.0.1
 */
const refNbLivre=document.querySelector(" .ajoutPanier__nbLivre"),refBtnPlus=document.querySelector(".ajoutPanier__plus"),refBtnMoins=document.querySelector(".ajoutPanier__moins");let intCptNbClicModifier=0;const refSousTotal=document.querySelector(".sous-total__input"),refTaxes=document.querySelector(".taxes__input"),refLivraison=document.querySelector(".livraison__input");function afficherMessagePanierVide(){var e=document.querySelectorAll(".livreAjoute");const t=document.querySelector(".sectionPanier__msgArticle");0===e.length?(t.innerText="Votre panier est vide.",refLivraison.value="0"):1===e.length?t.innerText="Votre panier contient "+e.length+" article.":t.innerText="Votre panier contient "+e.length+" articles."}function afficherBoutonsPlusMoins(){const e=document.querySelectorAll(".ajoutPanier__moins"),t=document.querySelectorAll(".ajoutPanier__plus");e.forEach(e=>{1===parseInt(e.closest("form").children[2].value)?e.setAttribute("disabled",""):e.removeAttribute("disabled")}),t.forEach(e=>{6===parseInt(e.closest("form").children[2].value)?e.setAttribute("disabled",""):e.removeAttribute("disabled")}),changerTotal()}function afficherBoutonMoins(){1==refNbLivre.value?refBtnMoins.setAttribute("disabled",""):refBtnMoins.removeAttribute("disabled"),changerTotal()}function afficherBoutonPlus(){6==refNbLivre.value?refBtnPlus.setAttribute("disabled",""):refBtnPlus.removeAttribute("disabled"),changerTotal()}function activerModification(e){arrBtnModifier=document.querySelectorAll(".changer"),"BUTTON"===e.target.tagName&&"Modifier"===e.target.children[1].innerHTML&&(0!==intCptNbClicModifier&&retirerEcouteursEvenements(),arrBtnModifier.forEach(e=>{e.parentNode.parentNode.classList.remove("borderSelection")}),e.target.parentNode.parentNode.classList.add("borderSelection"),document.querySelector(".borderSelection .confirmer").removeAttribute("hidden"),ajouterEcouteursEvenements(),intCptNbClicModifier++)}function modifierNbLivres(e){let t;"plus"===e.target.id?(t=e.target.previousElementSibling.value,intNbLivre=parseInt(t),intNbLivre++,e.target.previousElementSibling.value=intNbLivre):"moins"===e.target.id&&(t=e.target.nextElementSibling.value,intNbLivre=parseInt(t),intNbLivre--,e.target.nextElementSibling.value=intNbLivre),afficherBoutonMoins(),afficherBoutonPlus()}function changerTotal(){arrArticle=document.querySelectorAll(".livreAjoute"),arrArticle.forEach(e=>{intPrixUnitaire=parseFloat(e.children[1].children[2].children[0].innerHTML),intNbDeLivres=parseFloat(e.children[2].children[0].children[2].value),e.children[1].children[3].children[0].innerHTML=(intPrixUnitaire*intNbDeLivres).toFixed(2)}),afficherTotalAvantTaxes()}function changerBtnFavori(t){if("modificationArticle__btnSouhait"===t.currentTarget.classList[0]||"fa-heart"===t.currentTarget.classList[0]||"labelSouhait"===t.currentTarget.classList[0]){let e=t.target.closest(".modificationArticle__btnSouhait").children[0].classList;e.forEach(e=>{switch(e){case"fa-regular":document.querySelector(".fa-heart").classList.remove("fa-regular"),document.querySelector(".fa-heart").classList.add("fa-solid");break;case"fa-solid":document.querySelector(".fa-heart").classList.remove("fa-solid"),document.querySelector(".fa-heart").classList.add("fa-regular")}})}}function placerLabelBoutons(){const e=document.querySelectorAll(".label");e.forEach(e=>{window.innerWidth<700?e.classList.add("modaleLabel"):e.classList.remove("modaleLabel")})}function afficherTotalAvantTaxes(){arrArticle=document.querySelectorAll(".livreAjoute"),intTotalPrixLivres=0,arrArticle.forEach(e=>{e=parseFloat(e.children[1].children[3].children[0].innerHTML);intTotalPrixLivres+=e}),refSousTotal.value=intTotalPrixLivres.toFixed(2)+" $",afficherTPS(intTotalPrixLivres),afficherTVQ(intTotalPrixLivres),afficherTaxes(),afficherFraisLivraison(),afficherTotalAvecTaxes()}function afficherTPS(e){document.querySelector(".tps__input").value=(.05*e).toFixed(2)+" $"}function afficherTVQ(e){document.querySelector(".tvq__input").value=(.09975*e).toFixed(2)+" $"}function afficherTaxes(){intTPS=parseFloat(document.querySelector(".tps__input").value),intTVQ=parseFloat(document.querySelector(".tvq__input").value),refTaxes.value=(intTPS+intTVQ).toFixed(2)+" $"}function afficherFraisLivraison(){var e=parseFloat(refSousTotal.value);refLivraison.value=e<60?"15 $":"0 $"}function afficherTotalAvecTaxes(){document.querySelector(".total__input").value=(parseFloat(refSousTotal.value)+parseFloat(refTaxes.value)+parseFloat(refLivraison.value)).toFixed(2)+" $"}function ajouterEcouteursEvenements(){document.querySelector(".borderSelection .ajoutPanier__plus").addEventListener("click",modifierNbLivres),document.querySelector(".borderSelection .ajoutPanier__moins").addEventListener("click",modifierNbLivres)}function retirerEcouteursEvenements(){document.querySelector(".borderSelection .ajoutPanier__plus").removeEventListener("click",modifierNbLivres),document.querySelector(".borderSelection .ajoutPanier__moins").removeEventListener("click",modifierNbLivres)}window.addEventListener("load",afficherBoutonsPlusMoins),window.addEventListener("load",afficherTotalAvantTaxes),window.addEventListener("load",afficherMessagePanierVide),window.addEventListener("load",placerLabelBoutons),window.addEventListener("resize",placerLabelBoutons),window.addEventListener("click",activerModification),window.addEventListener("click",modifierNbLivres),window.addEventListener("click",changerBtnFavori),document.querySelector(".modificationArticle__btnSouhait").addEventListener("click",changerBtnFavori);